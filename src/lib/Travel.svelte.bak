<script>
	import Dropdown from './Dropdown.svelte';
	let distance_units = ['miles', 'km'];
	// 'ratio' is CO2 per mile
	let car = { 'ratio': 0.28 };
	let train = { 'ratio': 0.07 };
	let bus = {'ratio': 0.1 };
	let transport_modes = [car, train, bus];

	for (var i=transport_modes.length; i--;) {
		transport_modes[i].distance = 0
		transport_modes[i].units = 0
	};

	function get_carbon(transport_mode) {
		let distance = transport_mode.distance;
		if (transport_mode.units === 'km') {
			distance = distance * 0.62137;
		};
		return distance * transport_mode.ratio;
	};
	
	function sum_carbon(transport_modes) {
		let total = 0;
		for (var i=transport_modes.length; i--;) {
			total += get_carbon(transport_modes[i])
		};
		return total;
	};

	$: total_carbon = sum_carbon(transport_modes);
</script>

<p>Number of <Dropdown bind:value={car.units} options={distance_units}/> travelled by car per week:</p>
<input type='number' min='0' bind:value={car.distance}>

<p>Number of <Dropdown bind:value={train.units} options={distance_units}/> travelled by train per week:</p>
<input type='number' min='0' bind:value={train.distance}>

<p>Your travel emits {total_carbon.toFixed(2)}kg of co2 per week</p>
